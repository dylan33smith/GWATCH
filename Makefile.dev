# GWatch Development Makefile
# General development operations

.PHONY: help clear-cache test-syntax install-deps test-upload dev-server

# Default target
help:
	@echo "GWatch Development Commands:"
	@echo ""
	@echo "Development Operations:"
	@echo "  clear-cache       - Clear Symfony cache and logs"
	@echo "  test-syntax       - Check PHP syntax of all files"
	@echo "  install-deps      - Install/update Composer dependencies"
	@echo "  test-upload       - Prepare for testing module uploads"
	@echo "  dev-server        - Start Symfony development server"
	@echo ""
	@echo "Help:"
	@echo "  help              - Show this help message"

# Development Operations
clear-cache:
	@echo "ğŸ§¹ Clearing Symfony cache and logs..."
	@php bin/console cache:clear 2>/dev/null || echo "âŒ Cache clear failed"
	@rm -rf var/cache/* var/log/* 2>/dev/null || echo "âŒ Manual cache cleanup failed"
	@echo "âœ… Cache and logs cleared"

test-syntax:
	@echo "ğŸ” Checking PHP syntax..."
	@find src -name "*.php" -exec php -l {} \; | grep -v "No syntax errors detected" || echo "âœ… All PHP files have valid syntax"

install-deps:
	@echo "ğŸ“¦ Installing/updating Composer dependencies..."
	@composer install --no-dev --optimize-autoloader
	@echo "âœ… Dependencies installed"

# Testing
test-upload:
	@echo "ğŸ§ª Preparing for module upload testing..."
	@make clear-cache
	@echo "âœ… Ready for testing module uploads"
	@echo ""
	@echo "Next steps:"
	@echo "1. Go to your upload page"
	@echo "2. Upload a density_X.csv file"
	@echo "3. Check the results"

# Development Server
dev-server:
	@echo "ğŸš€ Starting Symfony development server..."
	@php -S localhost:8000 -t public/


